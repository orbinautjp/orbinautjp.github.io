<!DOCTYPE html>

<html lang="ja">

<head>
  <script src="/scripts/ga.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/styles/orbiterjp.css">
  <script src="/scripts/template.js" charset="utf-8" defer></script>
  <title>球面三角と打ち上げ方位</title>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script>
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    }
  </script>
</head>

<body>

  <main>

    <h1>球面三角と打ち上げ方位</h1>


    <p>
      ロケット・宇宙船の打ち上げ方位を計算する以下の公式について、簡単に説明します。
    </p>

    <blockquote>
      \begin{equation*}
      打ち上げ方位=\arcsin \left( \frac {\cos (ターゲットの軌道傾斜角)}{\cos (打ち上げ地点の緯度)}\right)
      \end{equation*}
    </blockquote>

    <nav>
      <ul>
        <li><a href="#drawtriangle">三角形を描く</a></li>
        <li><a href="#definition">球面三角形の定義</a></li>
        <li><a href="#formula">直角球面三角形の公式</a></li>
        <li><a href="#latitude">緯度と軌道傾斜角</a></li>
        <li><a href="#related">関連項目</a></li>
        <li><a href="#reference">参考文献</a></li>
      </ul>
    </nav>


    <h2 id="drawtriangle">三角形を描く</h2>


    <ul>
      <li>打ち上げ地点を通り、両極を結ぶ線（子午線）</li>
      <li>赤道</li>
      <li>ターゲットの軌道面</li>
    </ul>

    <figure>
      <img loading="lazy" src="/images/misc/spherical-trigonometry/001.png" width="379" height="379">
    </figure>

    <p>
      青が子午線、赤が赤道、黄色がターゲットの軌道面。<br>
      （緑は自機を真東に打ち上げたときの軌道面だが、今回は無関係）
    </p>

    <p>
      これら3つの線が交差するところに、三角形を描くことができる。<br>
      子午線とターゲットの軌道面（青と黄色）がつくる角度が、打ち上げ方位ということになる。
    </p>

    <p>
      この三角形について、以下の情報が明らかになっている。
    </p>

    <ul>
      <li>打ち上げ地点の緯度</li>
      <li>ターゲットの軌道傾斜角（赤道に対しての軌道面の角度）</li>
      <li>子午線と赤道が交差する角度（＝直角）</li>
    </ul>

    <p>
      内角2つ（軌道傾斜角と、子午線と赤道が交差する角度）がわかっている。<br>
      しかし球面上の三角形では、内角の和は180°から540°までの値を取る。※<br>
      このため、球面三角法の公式を使って3つ目の内角を求める必要がある。
    </p>

    <blockquote>

<p>※球面三角形の内角の和</p>

$$ 180^\circ \lt \theta \lt 540^\circ $$

</blockquote>


    <h2 id="definition">球面三角形の定義</h2>


    <p>
      球の中心を通る3つの平面を考える。<br>
      それぞれの平面が球の表面と交差してできる円を大円と呼ぶ。<br>
      3つの大円の弧で構成される図形が球面三角形である。
    </p>

    <p>
      球面三角形の内角は、これら3つの平面のなす角として定義される。<br>
      例えば軌道傾斜角は、赤道面（もしくは黄道面）と衛星の軌道平面のなす角である。
    </p>

    <figure>
      <img loading="lazy" src="/images/misc/spherical-trigonometry/003.png" width="800" height="800">
    </figure>


    <h2 id="formula">直角球面三角形の公式</h2>


    <p>
      3つの角をA, B, C、各辺をa, b, cとする。
    </p>

    <figure>
      <img loading="lazy" src="/images/misc/spherical-trigonometry/002.png" width="1438" height="833">
    </figure>

    <p>
      球の半径を1とすると、辺a, b, cの長さを角度で表すことができる。<br>
      例えば、赤道から打ち上げ地点までの子午線の長さは緯度で表すことができる。
    </p>

    <p>
      また、辺bは子午線の一部であるため、角Cが直角であることがわかっている。
    </p>

    <figure>
      <img loading="lazy" src="/images/misc/spherical-trigonometry/004.png" width="800" height="800">
    </figure>

    <p>
      点AからOCに垂線を下ろし、交点をLとする。<br>
      点AからOBに垂線を下ろし、交点をMとする。
    </p>

    <blockquote>
      \begin{align}
        AL &= \sin b \notag \\
        AM &= \sin c \notag
      \end{align}
    </blockquote>

    <p>
      LとMを結ぶ直線を引く。<br>
      三垂線の定理より、LMはOBに対して垂直であるため、∠AMLはBに等しい。<br>
      したがって、
    </p>

    <blockquote>
      \begin{align}
        AM \sin B &= AL \notag \\
        \sin c \sin B &= \sin b \notag
      \end{align}
    </blockquote>

    <p>
      Aおよびaについても同様に、
    </p>

    <blockquote>
      \begin{equation}
        \sin c \sin A = \sin a
      \end{equation}
    </blockquote>

    <p>
      また、AMおよびOLと、LMのあいだには以下のような関係がある。
    </p>

    <blockquote>
      \begin{align}
        AM \cos B &= LM \notag \\
        \sin c \cos B &= LM \notag \\
        \notag \\
        OL &= \cos b \notag \\
        OL \sin a &= LM \notag \\
        \cos b \sin a &= LM \notag
      \end{align}
    </blockquote>

    <p>
      したがって、
    </p>

    <blockquote>
      \begin{align}
        \sin c \cos B &= \cos b \sin a \\
        \sin c \cos A &= \cos a \sin b \notag
      \end{align}
    </blockquote>

    <p>
      (1)および(2)より、
    </p>

    <blockquote>
      \begin{align}
        \sin A &= \frac {\cos B} {\cos b} \notag \\
        A &= \arcsin \left( \frac {\cos B} {\cos b} \right) \notag
      \end{align}
    </blockquote>


    <h2 id="latitude">緯度と軌道傾斜角</h2>


    <p> \( \arcsin x \) の定義域は、\( -1 \leqq x \leqq 1 \) である。<br>
      打ち上げ地点の緯度が軌道傾斜角より大きいとき、cos(軌道傾斜角)/cos(緯度)の商は1より大きくなる。<br>
      したがって、緯度が軌道傾斜角より大きいとき、上記の式を使って打ち上げ方位を決めることはできない。</p>

    <p>このような場合は、いったん軌道上に出てから軌道面を一致させるか、Off-plane transferを実行する。</p>

    <ul>
      <li><a href="/tutorial/part9.html">Orbiterチュートリアル Part9 月への打ち上げ</a></li>
      <li><a href="/transximfd/off-plane-transfer.html">地球―月でのOff-plane transfer</a></li>
    </ul>


    <h2 id="related">関連項目</h2>


    <p>
      <a href="/basic/launch-azimuth.html">打ち上げ方位を計算する</a>
    </p>


    <h2 id="reference">参考文献</h2>


    <p>
      長谷川一郎，1996，『天文計算入門』恒星社厚生閣
    </p>

    <p>
      Murray, Daniel A, 1900, <i>Spherical trigonometry, for colleges and secondary schools</i>, New York, London,
      Bombay: Longmans, Green and Co.<br>
      ダウンロードリンク：<a href="https://archive.org/details/sphericaltrigono00murrrich" target="_blank"
        rel="noopener noreferrer">Internet Archive</a>
    </p>

  </main>

</body>

</html>